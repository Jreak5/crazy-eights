<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Crazy 8's</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      background-color: white;
    }
    #game {
      margin-top: 20px;
    }
    .card {
      display: inline-block;
      width: 60px;
      height: 90px;
      border: 1px solid #000;
      border-radius: 5px;
      margin: 5px;
      background-color: #fff;
      font-size: 20px;
      line-height: 90px;
      cursor: pointer;
      position: relative;
    }
    .hearts, .diamonds {
      color: red;
    }
    .spades, .clubs {
      color: black;
    }
    #suitModal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      justify-content: center;
      align-items: center;
    }
    #suitModalContent {
      background: white;
      padding: 20px;
      border-radius: 10px;
    }
    .suitOption {
      display: inline-block;
      font-size: 40px;
      margin: 10px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <h1>Crazy 8's</h1>
  <div id="game">
    <div>
      <button onclick="startGame()">New Game</button>
      <button onclick="drawCard()">Draw</button>
    </div>
    <h2>Your Hand</h2>
    <div id="playerHand"></div>
    <h2>Top of Pile</h2>
    <div id="pile"></div>
    <h2>Opponent</h2>
    <div id="opponentHand"></div>
  </div>

  <!-- Suit Picker Modal -->
  <div id="suitModal">
    <div id="suitModalContent">
      <h3>Pick a Suit</h3>
      <div class="suitOption hearts" onclick="chooseSuit('hearts')">â™¥</div>
      <div class="suitOption diamonds" onclick="chooseSuit('diamonds')">â™¦</div>
      <div class="suitOption spades" onclick="chooseSuit('spades')">â™ </div>
      <div class="suitOption clubs" onclick="chooseSuit('clubs')">â™£</div>
    </div>
  </div>

  <script>
    const suits = ['hearts','diamonds','spades','clubs'];
    const values = ['2','3','4','5','6','7','8','9','10','J','Q','K','A'];
    let deck = [];
    let playerHand = [];
    let opponentHand = [];
    let pile = [];
    let currentSuit = null;
    let playerTurn = true;

    function createDeck() {
      deck = [];
      for (let suit of suits) {
        for (let value of values) {
          deck.push({suit, value});
        }
      }
      // Shuffle
      for (let i = deck.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i+1));
        [deck[i], deck[j]] = [deck[j], deck[i]];
      }
    }

    function startGame() {
      createDeck();
      playerHand = deck.splice(0,5);
      opponentHand = deck.splice(0,5);
      pile = [deck.pop()];
      currentSuit = pile[0].suit;
      playerTurn = true;
      render();
    }

    function render() {
      const playerDiv = document.getElementById('playerHand');
      playerDiv.innerHTML = '';
      playerHand.forEach((card, i) => {
        const div = document.createElement('div');
        div.className = `card ${card.suit}`;
        div.textContent = card.value + getSuitSymbol(card.suit);
        div.onclick = () => playCard(i);
        playerDiv.appendChild(div);
      });

      const pileDiv = document.getElementById('pile');
      pileDiv.innerHTML = '';
      const top = pile[pile.length - 1];
      const div = document.createElement('div');
      div.className = `card ${top.suit}`;
      div.textContent = top.value + getSuitSymbol(top.suit);
      pileDiv.appendChild(div);

      const oppDiv = document.getElementById('opponentHand');
      oppDiv.innerHTML = '';
      opponentHand.forEach(() => {
        const div = document.createElement('div');
        div.className = 'card';
        div.textContent = 'ðŸ‚ ';
        oppDiv.appendChild(div);
      });
    }

    function getSuitSymbol(suit) {
      switch(suit) {
        case 'hearts': return 'â™¥';
        case 'diamonds': return 'â™¦';
        case 'spades': return 'â™ ';
        case 'clubs': return 'â™£';
      }
    }

    function isPlayable(card) {
      const top = pile[pile.length - 1];
      return card.value === '8' || card.suit === currentSuit || card.value === top.value;
    }

    function playCard(index) {
      if (!playerTurn) return;
      const card = playerHand[index];
      if (isPlayable(card)) {
        pile.push(card);
        playerHand.splice(index,1);
        currentSuit = card.suit;
        if (card.value === '8') {
          openSuitModal();
          return;
        }
        endPlayerTurn();
      }
    }

    function openSuitModal() {
      document.getElementById('suitModal').style.display = 'flex';
    }

    function chooseSuit(suit) {
      currentSuit = suit;
      document.getElementById('suitModal').style.display = 'none';
      endPlayerTurn();
    }

    function drawCard() {
      if (!playerTurn) return;
      // only one card draw allowed
      if (deck.length > 0) {
        const card = deck.pop();
        playerHand.push(card);
        if (isPlayable(card)) {
          // auto-play if valid
          pile.push(card);
          playerHand.pop();
          currentSuit = card.suit;
          if (card.value === '8') {
            openSuitModal();
            return;
          }
        }
      }
      endPlayerTurn();
    }

    function endPlayerTurn() {
      render();
      playerTurn = false;
      setTimeout(opponentTurn, 1000);
    }

    function opponentTurn() {
      let played = false;
      for (let i=0; i<opponentHand.length; i++) {
        if (isPlayable(opponentHand[i])) {
          const card = opponentHand[i];
          pile.push(card);
          opponentHand.splice(i,1);
          currentSuit = card.suit;
          if (card.value === '8') {
            currentSuit = suits[Math.floor(Math.random()*4)];
          }
          played = true;
          break;
        }
      }
      if (!played && deck.length > 0) {
        const card = deck.pop();
        opponentHand.push(card);
        if (isPlayable(card)) {
          pile.push(card);
          opponentHand.pop();
          currentSuit = card.suit;
          if (card.value === '8') {
            currentSuit = suits[Math.floor(Math.random()*4)];
          }
        }
      }
      render();
      playerTurn = true;
    }
  </script>
</body>
</html>
